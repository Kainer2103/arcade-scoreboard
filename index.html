<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arcade Scoreboard</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>

body {
    margin: 0;
    background-image: url("https://images.unsplash.com/photo-1511512578047-dfb367046420");
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    font-family: 'Press Start 2P', cursive;
    color: #fff;
    overflow-x: hidden;
}

/* CRT Scanlines */
body::before{
content:"";
position:fixed;
inset:0;
background:repeating-linear-gradient(
0deg,
rgba(0,0,0,0.2) 1px,
transparent 2px
);
pointer-events:none;
z-index:10;
}

/* Grid */
.grid{
position:fixed;
inset:0;
background:
linear-gradient(#ff006e22 1px,transparent 1px),
linear-gradient(90deg,#00f5ff22 1px,transparent 1px);
background-size:40px 40px;
animation:gridMove 12s linear infinite;
z-index:0;
}

@keyframes gridMove{
from{transform:perspective(500px) rotateX(60deg) translateY(0);}
to{transform:perspective(500px) rotateX(60deg) translateY(100px);}
}

.container{
max-width:900px;
margin:auto;
padding:30px;
position:relative;
z-index:1;
}

.frame{
border:3px solid #00f5ff;
box-shadow:0 0 20px #00f5ff;
background:#070015dd;
padding:20px;
}

/* Title */
h1{
text-align:center;
color:#00f5ff;
text-shadow:0 0 10px #00f5ff;
margin:10px 0;
}

/* Trophy */
.trophies{
text-align:center;
font-size:28px;
animation:float 3s infinite ease-in-out;
}

@keyframes float{
50%{transform:translateY(-10px);}
}

/* Header */
.header,.row{
display:grid;
grid-template-columns:60px 150px 100px;
gap:10px;
padding:10px;
font-size:10px;
}

.header{
color:#ff006e;
border-bottom:2px solid #ff006e;
}

/* Rows */
.row{
border:2px solid #b620e0;
margin:5px 0;
position:relative;
transition:.3s;
}

.row:hover{
transform:translateX(5px);
background:#b620e022;
}

.rank-1{border-color:#ffff00;}
.rank-2{border-color:#00f5ff;}
.rank-3{border-color:#ff006e;}

.score-bar{
position:absolute;
left:0;
bottom:0;
height:3px;
background:linear-gradient(90deg,#ff006e,#00f5ff);
}

.insert{
text-align:center;
margin-top:20px;
color:#ffff00;
animation:blink 1.5s infinite;
}

@keyframes blink{
50%{opacity:0;}
}

.loading{
text-align:center;
padding:30px;
color:#00f5ff;
}

.error{
text-align:center;
padding:30px;
color:#ff006e;
}

@media(max-width:600px){
.header,.row{
grid-template-columns:50px 100px 70px 70px;
font-size:8px;
}
}

/* ===== REALISTIC ARCADE CABINET ===== */

.arcade-scene{
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.arcade-cabinet{
  width:520px;
  background:#0c0c0c;
  border-radius:10px;
  padding:20px;
  box-shadow:
    0 60px 120px rgba(0,0,0,0.9);
}

/* Marquee */
.marquee{
  height:80px;
  background:#111;
  border-radius:6px;
  margin-bottom:20px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
  letter-spacing:2px;
  color:#bbb;
  box-shadow:inset 0 -15px 25px rgba(0,0,0,0.8);
}

/* Screen Bezel */
.screen-bezel{
  background:#050505;
  padding:25px;
  border-radius:8px;
  box-shadow:
    inset 0 0 40px #000,
    0 0 5px rgba(255,255,255,0.05);
  margin-bottom:25px;
}

/* Inner frame */
.screen-inner{
  background:#111;
  padding:15px;
  border-radius:6px;
  box-shadow:inset 0 0 25px #000;
}

/* Screen */
.screen-content{
  background:#000;
  border-radius:4px;
  padding:10px;
  box-shadow:inset 0 0 60px rgba(0,0,0,0.9);
}

/* Control Panel */
.control-panel{
  background:#111;
  border-radius:6px;
  padding:20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:inset 0 0 25px #000;
}

/* Joystick */
.joystick{
  position:relative;
  width:70px;
  height:70px;
}

.stick{
  position:absolute;
  bottom:15px;
  left:31px;
  width:8px;
  height:45px;
  background:#222;
}

.ball{
  position:absolute;
  bottom:55px;
  left:22px;
  width:26px;
  height:26px;
  background:#c40000;
  border-radius:50%;
  box-shadow:inset -3px -3px 6px rgba(0,0,0,0.6);
}

/* Buttons */
.buttons{
  display:flex;
  gap:15px;
}

.btn{
  width:34px;
  height:34px;
  border-radius:50%;
  background:#c40000;
  box-shadow:
    inset -3px -3px 6px rgba(0,0,0,0.6),
    inset 3px 3px 6px rgba(255,255,255,0.05);
}


</style>
</head>

<body>

<div class="arcade-scene">

  <div class="arcade-cabinet">

    <div class="marquee">
      ARCADE BOARD
    </div>

    <div class="screen-bezel">
      <div class="screen-inner">
        <div class="screen-content">
          
          <!-- DEIN BOARD BEGINNT HIER -->
          <div class="grid"></div>
          <div class="container">
            <div class="frame">
              <h1>HIGH SCORE</h1>
              <div class="trophies">üèÜ üëë üèÜ</div>
              <div id="board"></div>
              <div class="insert">‚ñ≤ INSERT COIN ‚ñ≤</div>
            </div>
          </div>
          <!-- DEIN BOARD ENDET HIER -->

        </div>
      </div>
    </div>

    <div class="control-panel">
      <div class="joystick">
        <div class="stick"></div>
        <div class="ball"></div>
      </div>

      <div class="buttons">
        <div class="btn"></div>
        <div class="btn"></div>
        <div class="btn"></div>
        <div class="btn"></div>
      </div>
    </div>

  </div>

</div>

</body>

<script>

/* =============================
   GOOGLE SHEET CSV LINK
============================= */

const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQzWlByVkCzcn8bGO9kPYH7eKkBJwDsPJjTqotjaWmOCopmy0rjA5b-RlVQ__pEBxDtHIpaUut19E5z/pub?output=csv";

const board = document.getElementById("board");
let lastTop = null;

/* Loading UI */
function showLoading(){
board.innerHTML='<div class="loading">LOADING...</div>';
}

/* Error UI */
function showError(){
board.innerHTML='<div class="error">FAILED TO LOAD</div>';
}

/* Parse CSV */
function parseCSV(text){

    const rows = text.trim().split("\n").slice(1);

    const data = rows.map(r=>{
        const c = r.split(",");
        return {
            date: c[0],
            score: Number(c[1])
        };
    });

    // sortieren nach Score
    data.sort((a,b)=>b.score-a.score);

    // Rang automatisch vergeben
    data.forEach((row,i)=>{
        row.rank = "#" + (i+1);
    });

    return data;
}


/* Beep */
function beep(){
const ctx=new AudioContext();
const o=ctx.createOscillator();
o.type="square";
o.frequency.value=440;
o.connect(ctx.destination);
o.start();
o.stop(ctx.currentTime+.1);
}

/* Confetti */
function confetti(){
for(let i=0;i<30;i++){
let d=document.createElement("div");
d.style.position="fixed";
d.style.width="6px";
d.style.height="6px";
d.style.background=["#ff006e","#00f5ff","#ffff00"][i%3];
d.style.left=Math.random()*100+"vw";
d.style.top="-10px";
d.style.transition="2s linear";
document.body.appendChild(d);
setTimeout(()=>{d.style.top="110vh";d.style.opacity=0;},10);
setTimeout(()=>d.remove(),2000);
}
}

/* Render */
function render(data){

data.sort((a,b)=>b.score-a.score);
const top=data.slice(0,10);
const max=Math.max(...top.map(x=>x.score),1);

board.innerHTML=`
<div class="header">
<div>RANK</div>
<div>DATE</div>
<div>SCORE</div>
</div>`;

top.forEach((r,i)=>{
let pct=r.score/max*100;
board.innerHTML+=`
<div class="row rank-${i+1}">
<div>#${i+1}</div>
<div>${r.date}</div>
<div>${r.score}</div>
<div class="score-bar" style="width:${pct}%"></div>
</div>`;
});

const avg=Math.round(data.reduce((s,x)=>s+x.score,0)/data.length||0);

board.innerHTML+=`
<div style="margin-top:15px;text-align:center;font-size:9px;color:#00f5ff">
RUNS: ${data.length} | AVG: ${avg}
</div>`;

if(lastTop!==null && top[0].score>lastTop) confetti();
lastTop=top[0].score;

beep();
}

/* Fetch */
async function load(){
showLoading();
try{
const r=await fetch(CSV_URL+"&t="+Date.now());
const t=await r.text();
render(parseCSV(t));
}catch(e){
showError();
}
}

load();
setInterval(load,30000);

</script>

</body>
</html>
